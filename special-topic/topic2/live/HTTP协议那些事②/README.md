# HTTP协议那些事②
## http2协议分析
* 怎么发现是http2的？
	- 第一次请求时，浏览器也不知道服务器是不是2.0，所以默认按http1.1协议进行请求，服务器和浏览器进行协商，服务器返回的响应中会带有伪头，如果浏览器支持http2的话，它会自动进行升级；如果浏览器不支持的话，看服务器的策略，如果服务器强制升级，浏览器会报错，如果服务器不强制升级，浏览器会降级到1.1协议
* http2的伪头字段
	- 伪头部字段是http2内置的几个特殊的以“：”开始的key，用于替代http/1.x中请求行/响应行中的信息，比如请求方法，响应状态码等，
		+ :method 目标url模式部分（请求）
		+ :scheme 目标url模式部门（请求）
		+ :suthority 目标url认证部分（请求）
		+ :path 目标url的路径和查询部分（绝对路径产生式和一个跟着“？”字符的查询产生式）（请求）
		+ :status 响应头中的http状态码部分（响应） 
* http2 协议分析
	- （http1使用文本形式传输 - ascii码）使用二进制格式传输，特点（更高效、更紧凑）工具：HexMiner  
	- 对报头压缩，降低开销（http1:串行传输（一个完了另一个才会继续）jgip：传输的内容体，对于头部不压缩，http2对头部也压缩）cookie比较长
	- 多路复用（一个网络通信的概念，资源并发传输（切成一小块一小块的），缺陷：资源发错重传会效率低），一个网络连接实现并行请求
	- 服务器主动推送，减少请求延迟
	- 默认使用加密
## 了解http3（google官网有源代码 - 研发中）
* http-over-QUIC被更名为http3（解决多路复用中的缺陷）
* QUIC协议是什么（QUIC UDP internet connection）
* http 3与http1.1和http2没有直接的关系
* http 3不是http2的扩展
* http 3将会是一个全新的web协议
* http 3目前处于制定和测试阶段
* 比较灵活
## http与反向代理
* 什么是代理，什么又是反向代理
	- 代理：网购里买不到自己想要的东西，我们需要找代购，代购（可以在国内国外来回穿梭）的意义就和代理（工作是接受你的请求，然后把你的请求传到你到达不了的地方）差不多。
	- 正向代理：客户端在内网，服务器在外网。不能直接访问外面的服务器，必须经过proxy才能访问
	- 反向代理：客户端在外网，服务器在内网。客户端只能通过proxy唯一的入口访问不同服务器
* 为什么要使用反向代理
* 都有哪些反向代理服务器
* 反向代理的用途（web server负责io密集型的东西，proxy负责cpu密集型的东西，也是适合io密集型的（网络））
	- 加密和ssl加速
	- 负载均衡：单独一个服务器，压力过大
	- 缓存静态内容
	- 压缩
	- 减速上传：可以控制流量，百度网盘限制流量（带宽限制）
	- 安全
	- 外网发布
* CDN技术：
	- 数据一致性（专用的vpn、自己拉光缆）
	- 循环复用DNS -> 反向代理服务器（中心服务器的镜像） -> 中心服务器
* 让nginx跑起来
	- 必须有c语言编译器：gcc
	- 在linux下的两种安装方案：（下载stable版本）yum/apt安装（自动帮助你配置服务）
	- 解压gz文件：tar zxvf(z：gz，x：解压缩，v：解压缩的过程能看的到，f：解压后的文件放在文件夹中) 自己编译
	- 在自己安装的虚拟机上，有可能yum找不到（需要把nginx添加到源上）
	- ls -l（查看操作权限，如果没有需要添加操作权限）
	- 配置文件：
		+ master process:主进程，调度进程，什么都不管
		+ worker process:只管干活
		+ .pid：管理进程
		+ event：配置事件处理，管理并发连接数（不要轻易去改）
		+ http块：http服务
		+ include：元数据类型
		+ keepalive:设置成非0（秒），有多久时间没有反应就把长链接断开
		+ upstream：放到server外面，+块的名称，块里面（server 本机ip：端口;）一个server反向代理，多个server负载均衡
		+ server：虚拟主机
			1. listen：端口
			2. server_name：域名
			3. location：静态的web服务器
			4. 代理路径：配置根上的时候把root和index都删除掉，他们会受到干扰，要把原始的头原封不动的转发过去（原因：因为只要经过代理，有些头会被替换掉，替换掉会覆盖掉收集到到的信息）

* 多进程
	- io - 事件驱动
* 其他
	- fffmpeg
	- fpm
	- 免费https证书：let‘s encrypt（有脚本 - 可以自动申请-定时任务-crontab）

### Nginx的反向代理与负载均衡
1. 什么是反向代理与负载均衡
* 我们有时候，用自己的计算机A想访问国外的某个网站B，但是访问不了，此时，有一台中间服务器C可以访问国外的网站B，那么，我们可以用自己的电脑访问服务器C，通过C来访问B的这个网站。那么这个时候，服务器C称为代理服务器，这种访问方式叫做正向代理。正向代理有一个特点，就是我们明确知道要访问哪个网站。
* 再如，当我们有一个服务器集中，并且服务器集群中的每台服务器的内容一样的时候，同样我们要直接从个人电脑访问到服务器集中的服务器的时候无法访问，且此时第三服务器能访问集群，这个时候，我们通过第三方服务器访问服务器集群的内容，但是此时我们并不知道是哪一台服务器提供的内容，此时的代理方式称之为反向代理。
* 当一台服务器的单位时间内的访问量越大的时候，服务器的压力会越大。当一台服务器压力大得超过自身得承受压力能力得时候，服务器会崩溃。为了避免服务器奔溃，让用户有更好地体验，我们通常同各国负载均衡得方式分担服务器压力。那么什么时候负载均衡呢？是这样，我们可以建立很多很多个服务器，这些服务器组成一个服务器集群，然后，当用户访问我们网站得时候，先访问一个中间服务器，再让这个中间服务器再服务器集群中选择一个压力较小得服务器，然后将该访问请求引入该选择得服务器。这样，用户得每次访问，都会保证服务器集群中的每个服务器的压力趋于平衡，分担了服务器压力，避免了服务器奔溃的情况。
2. nginx负载均衡的实现
* nginx是一款可以通过反向代理实现负载均衡的服务器，使用nginx服务实现负载均衡的时候，用户的访问受限会访问到nginx服务器，然后nginx服务器再从服务器集群表中选择压力较小的服务器，然后将改访问请求引向该服务器。若服务器集群中的某个服务器奔溃，那么从待选服务器中将该服务器删除，也就是说一个服务器加入奔溃了，那么nginx就肯定不会将访问请求引入该服务器了，
3. http upstream模块
* 什么是http upstream：是nginx服务器的一个重要模块。upstream模块实现在轮询和客户端ip之间实现后端的负载均衡。
* ip_hash指令：如何让同一个用户落在同一台服务器上
* server指令：
4. 其他负载均衡的方法
### 部署nodejs上线步骤
1. 打开https://brew.sh/index_zh-cn.html
2. brew search nginx  brew install nginx
3. brew info nginx
4. nginx -v 查看nginx信息
5. 启动sudo brew services start nginx(默认端口8080)
  * 备注：如果你安装过jenkins的话这里会失败
  * sudo launchctl unload/Library/LaunchDaemons/org.jenkins-ci.plist
  * systemctl start jenkins
6. 关闭sudo brew services stop nginx/nginx
7. nginx -s reload 、nginx -s stop
8. 打开nginx具体安装目录 查看配置文件 /usr/local/etc/nginx/
9. 验证配置文件nginx -t -c 自己的配置文件地址
10. 拷贝配置文件至node项目目录 重新修改
11. 服务器端的nginx地址
